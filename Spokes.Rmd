---
title: "Spokes"
author: "Luis Ángel Rodríguez García"
date: '2022-05-31'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Spokes

```{r}
load("spokes.RData")
```

```{r}
n <- dim(dirs)[1]
p <- dim(dirs)[3]-1
r <- dim(dirs)[2]
spokes <- array(0, c(n, p+1, r))
for(i in seq_len(r)){
  spokes[,,i] <- dirs[,i,]
}
```

```{r}
#Time difference of 28.40103 mins
rho_spokes_perp16 <- rho_optim_parallel(spokes, 16)
to_perp(spokes, rho_spokes_perp16, cosine_polysph(spokes))

#   [1] 15.99908 15.99912 15.99902 15.99814 15.99885 15.99985 16.53955 15.99998 15.99933 15.99936 15.99940 15.99927 15.99999 15.99879 15.99944 15.99883 15.99921
#  [18] 15.99918 15.99936 15.99910 16.00000 15.99912 15.99938 15.99926 15.99985 15.99931 15.99922 15.99999 16.00000 15.99968 15.99967 15.99890 15.99895 15.99960
#  [35] 15.99997 15.99900 15.99960 15.99927 15.99883 15.99922 15.99867 15.99950 15.99908 15.99982 25.19228 15.99977 15.99895 15.99987 15.99909 15.99903 15.99920
#  [52] 15.99914 15.99945 15.99893 15.99891 15.99895 15.99908 15.99989 15.99956 15.99923 15.99842 15.99764 15.99872 15.99995 15.99966 15.99973 15.99907 15.99902
#  [69] 15.99994 15.99995 15.99927 15.99914 15.99999 15.99926 15.99904 15.99920 15.99946 15.99801 15.99953 15.99903 15.99871 15.99971 15.99908 15.99995 15.99972
#  [86] 15.99944 15.99899 15.99950 15.99899 15.99903 15.99907 15.99996 15.99946 15.99906 15.99913 15.99994 15.99999 15.99959 15.99867 16.23076 15.99950 15.99953
# [103] 15.99951 15.99987 16.00000 15.99832 15.99945 15.99957 15.99937 15.99898 15.99976 15.99955 15.99904 15.99995 15.99923 15.99949 15.99950 15.99886 15.99888
# [120] 15.99952 15.99959 15.99990 15.99942 15.99921 15.99996 15.99923 15.99794 15.99871 15.99791 15.99907 15.99992 15.99893 15.99938 15.99861 15.99977 15.99941
# [137] 15.99876 15.99853 15.99899 15.99995 15.99917 15.99975 15.99847 15.99864 15.99925 15.99939 15.99918 15.99999 15.99998 15.99945 15.99858 15.99993 15.99978
# [154] 15.99863 15.99971 15.99934 15.99838 15.99895 15.99834 15.99914 15.99998 15.99876 15.99994 15.99995 15.99913 15.99952 15.99872 15.99952 15.99995 15.99953
# [171] 15.99897 15.99836 15.99905 16.13348 15.99902 18.53126 15.99907

```

```{r}
# Time difference of 27.734 mins
rho_spokes_perp30 <- rho_optim_parallel(spokes, 30)
to_perp(spokes, rho_spokes_perp30, cosine_polysph(spokes))

#   [1] 29.99894 29.99995 29.99915 29.99895 29.99984 29.99830 29.99944 29.99982 29.99944 29.99959 29.99928 29.99882 29.99872
#  [14] 29.99947 29.99997 29.99970 29.99867 29.99930 29.99869 29.99914 29.99985 29.99851 29.99932 29.99872 29.99833 29.99933
#  [27] 29.99983 29.99915 29.99890 29.99920 29.99948 29.99992 29.99882 29.99951 29.99926 29.99900 29.99953 29.99999 29.99893
#  [40] 29.99915 29.99870 29.99942 29.99926 29.99904 29.99988 29.99991 29.99935 29.99990 29.99911 29.99920 29.99922 29.99914
#  [53] 29.99957 29.99837 29.99924 29.99991 29.99907 29.99921 29.99925 29.99947 29.99888 29.99832 29.99927 29.99924 29.99973
#  [66] 29.99909 29.99806 29.99891 29.99902 29.99907 29.99911 29.99925 29.99868 29.99978 29.99941 29.99995 29.99937 29.99762
#  [79] 29.99993 29.99995 29.99861 29.99924 29.99863 29.99994 29.99873 29.99931 29.99952 29.99943 29.99878 29.99905 29.99905
#  [92] 29.99940 29.99897 29.99942 29.99870 29.99897 29.99894 29.99961 29.99903 29.99954 29.99931 29.99914 29.99900 29.99924
# [105] 29.99998 29.99884 29.99972 29.99904 29.99928 29.99909 29.99968 29.99950 29.99938 29.99999 29.99943 29.99920 29.99934
# [118] 29.99860 29.99869 29.99927 29.99998 29.99993 29.99900 29.99972 29.99950 29.99942 29.99993 29.99992 29.99854 29.99890
# [131] 30.00000 29.99837 29.99926 29.99882 29.99955 29.99940 29.99813 29.99788 29.99907 29.99921 29.99878 29.99945 29.99868
# [144] 29.99854 29.99859 29.99921 29.99929 29.99895 29.99960 29.99976 29.99899 29.99911 29.99915 29.99812 29.99955 29.99910
# [157] 29.99852 29.99907 29.99836 29.99861 29.99860 29.99903 29.99997 29.99878 29.99892 29.99949 29.99835 29.99874 29.99996
# [170] 29.99918 29.99905 29.99896 29.99971 29.99946 29.99924 29.99949 29.99875

```

```{r}
# Time difference of 26.94043 mins
rho_spokes_perp45 <- rho_optim_parallel(spokes, 45)
to_perp(spokes, rho_spokes_perp45, cosine_polysph(spokes))

#   [1] 0.5258628 0.5337427 0.4414812 0.5049328 0.5287683 0.3809390 0.5405910 0.4819868 0.4494982 0.4965206 0.4549612
#  [12] 0.4151778 0.4638648 0.4723166 0.4635218 0.5195381 0.3306192 0.4908912 0.4546033 0.3882923 0.4956639 0.4349152
#  [23] 0.5125312 0.4464203 0.4526421 0.4619689 0.5032107 0.5171677 0.4109577 0.4733607 0.5117958 0.4854495 0.3977564
#  [34] 0.5025362 0.5065640 0.4764493 0.5188822 0.5144806 0.5365159 0.5059201 0.5221114 0.4774798 0.4866013 0.4798689
#  [45] 0.5887623 0.4846672 0.4995517 0.4628338 0.5342921 0.4903833 0.5197606 0.5361845 0.5184733 0.3807043 0.5310957
#  [56] 0.4334904 0.4190836 0.5083247 0.4415210 0.5214888 0.4959469 0.4670373 0.5064182 0.5065596 0.5227086 0.4092461
#  [67] 0.4301495 0.4418994 0.4802334 0.4919531 0.3637297 0.5331257 0.4537283 0.4685088 0.4966094 0.5199105 0.5066494
#  [78] 0.3535077 0.4940574 0.5323061 0.4050412 0.3944081 0.4272915 0.5418755 0.5074452 0.4819538 0.4722758 0.5122217
#  [89] 0.4901634 0.3681245 0.4207385 0.5339346 0.4944218 0.4959782 0.4529643 0.4132529 0.5480660 0.4887227 0.4890410
# [100] 0.5495346 0.4699202 0.4879139 0.4153307 0.4284239 0.4561029 0.4628505 0.5123161 0.4819910 0.4762671 0.5161326
# [111] 0.4773126 0.4638610 0.5424521 0.4750533 0.4597061 0.4477758 0.5496930 0.4150379 0.3111997 0.3679880 0.4786987
# [122] 0.4658689 0.4997514 0.5111953 0.4907792 0.4646708 0.4843782 0.4994427 0.5248407 0.3425372 0.5050498 0.4481508
# [133] 0.4749223 0.4505960 0.5069712 0.4473898 0.3364215 0.3684926 0.4614074 0.5066930 0.3799580 0.4802308 0.4731371
# [144] 0.3839208 0.4946193 0.3693773 0.4924230 0.4826683 0.4143064 0.4578476 0.4989875 0.5595065 0.4873920 0.4066608
# [155] 0.4982144 0.4929655 0.4218215 0.4385281 0.4852128 0.3923317 0.4043278 0.3642422 0.4581318 0.4720012 0.5253521
# [166] 0.4569186 0.4017296 0.4276868 0.5061885 0.4394533 0.4922630 0.4595445 0.5167584 0.5380559 0.4391462 0.5533616
# [177] 0.4809572

```

```{r}
Y <- psc_sne(spokes, 1, rho_psc_list = rep(0.5, nrow(spokes)), colors = ifelse(ids_labs, 2, 1), num_iteration=1000, visualize_prog = TRUE, eta=250)
```

```{r}
Y_rad <- DirStats::to_rad(Y)
r <- 1
theta <<- Y_rad
plot(r*sin(theta),
     r*cos(theta),
     col=colors,
     xlim=c(-max(r),max(r)),
     ylim=c(-max(r),max(r)))

polygon(max(r)*sin(seq(0,2*pi,length.out=100)),max(r)*cos(seq(0,2*pi,length.out=100)))
```
```{r}
Y <- psc_sne(spokes, 2, rho_psc_list = rho_spokes_perp45, colors = ifelse(ids_labs, 2, 1), num_iteration=1000, 
             visualize_prog = TRUE)
```


```{r}
rgl::plot3d(0, 0, 0, xlim = c(-1, 1), ylim = c(-1, 1), zlim = c(-1, 1),
             radius = 1, type = "s", col = "lightgray",
             lit = FALSE)
rgl::points3d(Y, col = ifelse(ids_labs, 2, 1))
```


## Including Plots

